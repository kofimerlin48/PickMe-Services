<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <title>Groceries - PickMe Services</title>

  <!-- ========= LINK TO SEPARATED CSS FILE ========== -->
  <link rel="stylesheet" href="/Groceries/groceries.css?v=1">
</head>

<body>

  <!-- ========= HEADER CODE STARTS HERE ================== -->
  <div id="header-placeholder"></div>
  <script>
    (async () => {
      try {
        const response = await fetch('/header.html?v=' + Date.now());
        if (!response.ok) throw new Error('Failed to load header');
        let html = await response.text();
        const pageTitle = "Groceries";
        html = html.replace(/<h1[^>]*>.*?<\/h1>/i,
          `<h1 style="margin:0; font-weight:bold; color:#c12872; font-size:24px; position:absolute; left:50%; transform:translateX(-50%);">${pageTitle}</h1>`
        );
        document.getElementById('header-placeholder').innerHTML = html;

        document.querySelectorAll('#header-placeholder script').forEach(oldScript => {
          const newScript = document.createElement('script');
          newScript.textContent = oldScript.textContent;
          oldScript.replaceWith(newScript);
        });
      } catch (error) {
        console.error(error);
      }
    })();
  </script>

  <!-- =========================
       Groceries Page Structure
  ========================== -->

  <div class="main-wrapper">

    <!-- Search bar -->
    <div class="search-container">
      <input id="searchInput" type="text" placeholder="Search product..." />
      <button id="searchBtn">Search</button>
    </div>

    <!-- Category filter -->
    <div class="category-container">
      <button class="category-btn" data-category="all">All</button>
      <button class="category-btn" data-category="fruits">Fruits</button>
      <button class="category-btn" data-category="vegetables">Vegetables</button>
      <button class="category-btn" data-category="meat">Meat</button>
      <button class="category-btn" data-category="drinks">Drinks</button>
      <button class="category-btn" data-category="others">Others</button>
    </div>

    <!-- Items list -->
    <div id="itemsContainer" class="items-container"></div>

    <!-- Cart button -->
    <button id="cartBtn" class="floating-cart-btn">
      ðŸ›’ <span id="cartCount">0</span>
    </button>

  </div>

  <!-- Item Modal -->
  <div id="itemModal" class="modal">
    <div class="modal-content">
      <span id="itemModalClose" class="close">&times;</span>
      <img id="modalImage" alt="Item Image"/>
      <h2 id="modalName"></h2>
      <p id="modalPrice"></p>
      <p id="modalDescription"></p>
      <button id="modalAddToCartBtn" class="add-to-cart-btn">Add to Cart</button>
    </div>
  </div>

  <!-- Cart Modal -->
  <div id="cartModal" class="modal">
    <div class="modal-content cart-content">
      <span id="cartModalClose" class="close">&times;</span>
      <h2>Your Cart</h2>
      <div id="cartItemsList"></div>
      <p id="cartTotal"></p>
      <button id="checkoutBtn" class="checkout-btn">Checkout</button>
    </div>
  </div>

  <!-- Checkout Modal -->
  <div id="checkoutModal" class="modal">
    <div class="modal-content checkout-content">
      <span id="checkoutModalClose" class="close">&times;</span>
      <h2>Checkout</h2>

      <input id="customerName" type="text" placeholder="Your name" />
      <input id="customerPhone" type="tel" placeholder="Phone number" />
      <input id="customerLocation" type="text" placeholder="Delivery location" />

      <p id="checkoutTotal"></p>

      <button id="payNowBtn" class="pay-btn">Pay Now</button>
    </div>
  </div>

  <!-- ========= JS Loader (with cache busting) ========= -->
  <script type="module">
    const script = document.createElement('script');
    script.type = 'module';
    script.src = '/Groceries/groceries.js?v=' + Date.now();
    document.body.appendChild(script);
  </script>

</body>
</html>
